<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <record id="view_task_form" model="ir.ui.view">
        <field name="name">task.management.form</field>
        <field name="model">task.management</field>
        <field name="arch" type="xml">
            <form string="Task Creation">
                <header>
                    <field name="status" widget="statusbar" options="{'clickable': False}" statusbar_visible="inspection, monitoring, agree_disagree, corrections, completed, reporting" groups="task_management.group_inspector,task_management.group_admin, task_management.group_user"/>
                    <button name="action_submit_for_monitoring" type="object" string="Submit" class="oe_highlight"
                        invisible= "status != 'inspection'" groups="task_management.group_inspector, task_management.group_admin"/>

                    <button name="action_assign_to_user" type="object" string="Assign to User" class="oe_highlight"
                        invisible= "status != 'monitoring'" groups="task_management.group_admin"/>

                    <button name="action_assign_to_recheck" type="object" string="Recheck" class="oe_highlight"
                        invisible= "status != 'monitoring'" groups="task_management.group_admin"/>

                    <button name="action_user_add_comment" type="object" string="Submit" class="oe_highlight"
                        invisible= "status != 'user_check'" groups="task_management.group_user"/>
                    <button name="action_admin_review" type="object" string="Admin Review" invisible="status != 'agree_disagree'" groups="task_management.group_admin"/>


                    <button name="action_report_to_manager_or_complete" type="object" string="Mark as Completed" class="oe_highlight"
                        invisible= "status != 'completed'" groups="task_management.group_inspector,task_management.group_admin"/>
                </header>
                <sheet>
                    <group>
                        <group>
                            <field name="date" readonly="user_id in ('task_management.group_user')"/>
                            <field name="task_name" readonly="status == 'user_check'"/>
                            <field name="user_id" invisible="status == 'inspection'" readonly="status == 'user_check'"/>
                            <field name="department_id" options="{'no_create': True}" readonly="status == 'user_check'"/>
                            <field name="ledger" readonly="status == 'user_check'"/>
                            <field name="voucher_type" readonly="status == 'user_check'"/>
                        </group>
                        <group>

                            <field name="current_user_department_id" invisible="1"/>
                            <field name="user_manager"/>
                            <field name="find1"/>
                            <field name="find2"/>
                            <field name="remarks"/>
                            <field name="status" invisible="1"/>
                        </group>
                    </group>
                    <group>
                        <field name="comment" groups="task_management.group_inspector,task_management.group_admin"/>
                        <field name="explanation" invisible = "status in ('inspection','monitoring')"/>
                        <field name="is_satisfactory" invisible="status != 'agree_disagree'" groups="task_management.group_admin"/>
                    </group>
                </sheet>
                 <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"
                           groups="base.group_user"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>

    <record id="view_task_tree" model="ir.ui.view">
        <field name="name">task.management.tree</field>
        <field name="model">task.management</field>
        <field name="arch" type="xml">
            <tree string="Tasks">
                <field name="date"/>
                <field name="task_name"/>
                <field name="department_id"/>
                <field name="ledger"/>
                <field name="voucher_type"/>
                <field name="find1"/>
                <field name="find2"/>
                <field name="remarks"/>
                <field name="status"/>
            </tree>
        </field>
    </record>


<!--    <record id="view_task_search" model="ir.ui.view">-->
<!--        <field name="name">task.management.search</field>-->
<!--        <field name="model">task.management</field>-->
<!--        <field name="arch" type="xml">-->
<!--            <search string="Search Tasks">-->
<!--                <field name="date"/>-->
<!--                <field name="task_name"/>-->
<!--                <field name="department_id"/>-->
<!--                <field name="voucher_type"/>-->

<!--&lt;!&ndash;            <filter string="My Department" domain="[('department_id', '=', current_user_department_id)]"/>&ndash;&gt;-->
<!--                <group expand="1" string="Group By">-->
<!--                    <filter string="Department" context="{'group_by': 'department_id'}"/>-->
<!--                    <filter string="Voucher Type" context="{'group_by': 'voucher_type'}"/>-->
<!--                </group>-->
<!--            </search>-->
<!--        </field>-->
<!--    </record>-->

    <!-- Action -->
    <record id="action_task_management" model="ir.actions.act_window">
        <field name="name">Task Management</field>
        <field name="res_model">task.management</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" ref="view_task_tree"/>
    </record>

    <!-- Menu -->
    <menuitem id="menu_task_management_root" name="Task Management" sequence="10" />
    <menuitem id="menu_task_management" name="Tasks" parent="menu_task_management_root"
              action="action_task_management" sequence="10"/>


</odoo>

